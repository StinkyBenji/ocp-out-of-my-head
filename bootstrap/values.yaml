default:
  app:
    enableAutoSync: true
    enabled: true
    autoSyncPrune: true
    annotations:
      argocd.argoproj.io/sync-options: SkipDryRunOnMissingResource=true,ServerSideApply=true
    destination:
      namespace: openshift-gitops
      server: https://kubernetes.default.svc
    source:
      repoURL: git@github.com:StinkyBenji/ocp-out-of-my-head.git

projects:
  - name: cluster-config
    description: Project for basic cluster configuration
    namespace: openshift-gitops
    sourceRepos:
      - git@github.com:StinkyBenji/ocp-out-of-my-head.git
      - git@github.com:StinkyBenji/some-helm-charts.git
      - git@github.com:StinkyBenji/cert-manager-webhook-hetzner.git
    destinations:
      - namespace: '*'
        server: https://kubernetes.default.svc
    clusterResourceWhitelist:
      - group: '*'
        kind: '*'

applications:
  - name: openshift-pipelines
    project: cluster-config
    source:
      path: components/apps/openshift-pipelines-operator/overlays/latest

  - name: cert-manager-operator
    annotations:
      argocd.argoproj.io/sync-wave: "1"
    project: cluster-config
    source:
      path: components/apps/cert-manager-operator/base

  - name: custom-console
    project: cluster-config
    source:
      path: components/configs/console-route/base

  - name: cert-manager-webhook-hetzner
    annotations:
      argocd.argoproj.io/sync-wave: "2"
    destination:
      namespace: cert-manager
    project: cluster-config
    source:
      path: deploy/cert-manager-webhook-hetzner
      repoURL: git@github.com:StinkyBenji/cert-manager-webhook-hetzner.git
      helm:
        values: |
          groupName: ocp4.whatever.out-of-my-head.de
          certManager:
            namespace: cert-manager
            serviceAccountName: cert-manager
          secretName:
            - hetzner-api-token
          podSecurityContext:
            runAsGroup:
            runAsUser:
          securityContext:
            runAsUser:
            allowPrivilegeEscalation: false
            capabilities:
              drop: ["ALL"]

  - name: letsencrypt
    annotations:
      argocd.argoproj.io/sync-wave: "3"
    project: cluster-config
    autoSyncPrune: false
    source:
      path: components/configs/letsencrypt/base

  - name: oauth
    project: cluster-config
    autoSyncPrune: false
    source:
      path: components/configs/oauth/overlays/gitlab

  - name: ntp-config
    annotations:
      argocd.argoproj.io/sync-wave: "1"
    project: cluster-config
    autoSyncPrune: false
    source:
      path: components/configs/ntp-config

  - name: certificates
    annotations:
      argocd.argoproj.io/sync-wave: "4"
    project: cluster-config
    autoSyncPrune: false
    source:
      path: components/configs/certificates/base
